<!DOCTYPE html>
<html>
<head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="css/materialize.min.css" media="screen,projection"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
    <div class="container">
        <h5>旗艦 CFR</h5>
        <div class="row" id="top">
            <a href="processSheetsData();">
                <i class="material-icons" style="font-size: 15px;">keyboard_arrow_right</i>展開
            </a>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
        google.charts.load('current', {'packages':['corechart']});

        function init() {
            var url ='https://docs.google.com/spreadsheets/d/1rqzP8llo3rywXwTukFZeP1VFN4eSMCeOZMYA0mLi2fQ/edit?usp=sharing';
            var query = new google.visualization.Query(url);
            query.setQuery('select *');
            query.send(processSheetsData);
        }   

        google.charts.setOnLoadCallback(init);

        function processSheetsData(response) {
            var data = response.getDataTable();
            var columns = data.getNumberOfColumns();
            var rows = data.getNumberOfRows();
            var s = "";
            for (var r=1 ; r<rows ; r++) {
                s+= `
                    <div class="col s12 m12 l4">
                        <div class="card">
                            <div class="card-image">
                                <img src="${data.getFormattedValue(r,3)}">
                                <span class="card-title">${data.getFormattedValue(r,1)}</span>
                            </div>
                            <div class="card-content">
                                <p>${data.getFormattedValue(r,2)}</p>
                            </div>
                            <div class="card-action">
                                <a href="${data.getFormattedValue(r,4)}">更多資訊</a>
                            </div>
                        </div>
                    </div>
                `;
            }
            document.getElementById("top").innerHTML = s;
        }
    </script>
</body>
</html>
